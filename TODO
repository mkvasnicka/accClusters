TODO
====

+ TODO comment v functions_map_preparation.R


Funkcionalita
-------------
- hotovo -- zkontrolovat:
    - čištění paměti po velkých výpočtech, aby se používal optimální počet jader (jinak nefunguje dobře odhad workerů v PWALK()) -- možnosti:
        - skripty, kde je víc výpočetně náročných věcí rozdělit -- v místě time_to_recover_memory()
            - bash skript updata_data.sh upravit tak, že bez -k se dělají jen věci pro shiny -- zkontrolovat flow
            - vyhodit time_to_recover_memory() z definic v auxiliary
        - použít gc a čas + zjistit počet jader na začátku, a pak ho předat následujícím funkcím
            - get_number_of_workers(profiles$NO_OF_WORKERS[1], profiles$RAM_PER_CORE_GENERAL[1])
            - get_number_of_workers(profiles$NO_OF_WORKERS_ACCIDENTS[1], profiles$RAM_PER_CORE_ACCIDENTS[1])
    - aktualizovat všechny balíky a vyzkoušet
    - PWALK logging: změnit počet workerů v logu z počtu nastavených workerů na min. z nich a počtu úkolů (prvků .l)
    - tvorba nehod: přidat kontrolu, že nehody leží v ČR
        - vypsat varování, kolik nehod má souřadnice NA a kolik neleží v ČR
        - zahodit
        - vyžaduje mít shapefile celé republiky


Parametrizace
-------------
- najít optimální nastavení parametrů
    - podívat se, jak se liší klastry pro continuous a discontinuous
    - podívat se, co dělá adaptive
    - podívat se, co dělá bandwidth
    - podívat se, co dělá cost
    - podívat se, jak se liší klastry mezi obdobími pro různá nastavení (stabilnější je asi lepší)
    - rozmyslet si i délku období -- jsou 3 roky dost? -- klastry se mezi obdobími dost liší (Brno venkov)


Testovat
--------
- znovu se aktualizovaly nehody -- má dobře závislosti?
- zkontrolovat závislosti v is_behind() a districts_behind()
- jaké sloupce obsahuje tabulka nehod + ty, které používáme, standardizovat
    - pro případ, že policie sloupce přejmenuje -- není kulturní, abychom používali jejich interní značky
    - nutné domluvit se Štěpánem, co z toho použije
        - data by to mělo chystat i pro něj -- aby se vzala data z guts a šoupla do shiny app
- při exportu do shiny ořezat lixely a klastry na okres -- asi už je -- zkontrolovat
    - lixely nechat jen ty, které jsou uvnitř skutečného okresu
    - klastry nechat celé, které aspoň částí zasahují do okresu
- zkontrolovat grid_shape v NKDE
    - NKDE i v nové verzi padalo, když tam byl rok 2022
- otestovat novou verzi densities
- pro všechny okresy:
    - zkontrolovat počet souvislých podgrafů
    - spustit kontrolu, o které psal Gelb
- Brno-venkov -- kdy se vyhodí Brno město? budou tam pak vůbec nějaké klastry?
    - podívat se, jak se počítá
    - klastrů je tam při současném nastavení docela dost


Nehody 2022
-----------
- zkontrolovat nehody za 2022
    - souřadnice + zbytek CSV
    - .rds


Čištění
-------
- vyhodit nepoužívané soubory/adresáře
- vyhodit:
    - unit_cost(s)()
- vyhodit testovací kód z functions_map_preparation.R
- do hlaviček prepare_*.R přidat, který soubory to vyžaduje a které vytváří
