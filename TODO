TODO
====

+ TODO comment v functions_map_preparation.R
+ TODO comment v functions_cluster_preparation.R


Bugs
----
- nehody pro výpočet se zbyteně aktualizují


Funkcionalita
-------------
- hotovo -- zkontrolovat:
    - balancování zátěže
    - aktualizovat všechny balíky a vyzkoušet


Parametrizace
-------------
- najít optimální nastavení parametrů
    - podívat se, jak se liší klastry pro continuous a discontinuous
    - podívat se, co dělá adaptive
    - podívat se, co dělá bandwidth
    - podívat se, co dělá cost
    - podívat se, jak se liší klastry mezi obdobími pro různá nastavení (stabilnější je asi lepší)
    - rozmyslet si i délku období -- jsou 3 roky dost? -- klastry se mezi obdobími dost liší (Brno venkov)
- co se zdá:
    - continuous / non-continuous
        - když jsou váhy podle VSL, pak continuous dělá míň nepatrně větších klastrů + sem tan nějaký navíc oproti non-continuous
        - když jsou váhy equal, tak se to ale dost liší
        - jako smysluplnější vidím continuous
    - váhy
        - když jsou váhy equal, hledá to parkoviště a jiné bezvýznamné věci
        - když jsou váhy podle VSL, je to strašně vychýlené směrem ke smrťákům a těžkým zraněním
        - přitom škoda je asi do jisté míry náhodná
        - navíc některé nehody mají materiální škodu 0, takže se při výpočtu vůbec nepočítají
        - co z toho plyne:
            - asi je potřeba dát všem nehodám nějakou konstatní váhu
            - je potřeba nějak nivelizovat důsledky (jejich váhy) oproti VSL
            - možnosti: Pišvejcova čísla
            - Štěpánův návrh mít jen dvě váhy:
                - autonomní váhu pro škody na plechu u každé nehody
                - jednu váhu pro jakýkoli typ zranění odvozený od VSL -- podle toho, jaká se stane škoda a
                  podle jejich frekvence mezi nehodami -- viz skript tmp/find_weights.R



Testovat
--------
- jaké sloupce obsahuje tabulka nehod + ty, které používáme, standardizovat
    - pro případ, že policie sloupce přejmenuje -- není kulturní, abychom používali jejich interní značky
    - nutné domluvit se Štěpánem, co z toho použije
        - data by to mělo chystat i pro něj -- aby se vzala data z guts a šoupla do shiny app
- při exportu do shiny ořezat lixely a klastry na okres -- asi už je -- zkontrolovat
    - lixely nechat jen ty, které jsou uvnitř skutečného okresu
    - klastry nechat celé, které aspoň částí zasahují do okresu
- zkontrolovat grid_shape v NKDE
    - NKDE i v nové verzi padalo, když tam byl rok 2022
- pro všechny okresy:
    - zkontrolovat počet souvislých podgrafů
    - spustit kontrolu, o které psal Gelb
- Brno-venkov -- kdy se vyhodí Brno město? budou tam pak vůbec nějaké klastry?
    - podívat se, jak se počítá
    - klastrů je tam při současném nastavení docela dost


Nehody 2022
-----------
- zkontrolovat nehody za 2022
    - souřadnice + zbytek CSV
    - .rds


Čištění
-------
- odstranit nepotřebné balíky v renv
- vyhodit nepoužívané soubory/adresáře
- vyhodit:
    - unit_cost(s)()
- vyhodit testovací kód z functions_map_preparation.R
- do hlaviček prepare_*.R přidat, který soubory to vyžaduje a které vytváří
