---
title: "Jak hledáme klastry nehod"
subtitle: "TAČR CK01000049 *Tvorba pokročilých nástrojů pro analýzu dopravních nehod pro Policii ČR*"
author: "Michal Kvasnička"
institute: "Masarykova univerzita"
format:
  beamer:
    include-in-header:
      - text: |
          \usepackage{graphicx}
          \def\rightfig[#1][#2]{\vbox to 0pt{\hbox to \textwidth{\hss\includegraphics[width=#1\textwidth]{#2}}\vss}}
    aspectratio: 1610
    theme: Madrid
editor: visual
---

## Možné přístupy

\rightfig[0.65][McSwiggan_road_accidents.png]

Možné metody hledání klastrů:

-   několik nehod blízko sebe

-   local Moran's I / Gettis-Ord

-   kernel density

    -   spatial (heat map)

    -   **network**

\

Váhy nehod:

-   všechny nehody mají stejnou váhu

-   **váha nehod závisí na jejich závažnosti (důsledcích)**



## Network Kernel Density Estimation

::: {layout="[[30,70], [100]]"}
![](Wiki_KDE.png)

![](McSwiggan_nkde_3d.png){width=100%}
:::


## Praktický postup výpočtu NKDE

- z OpenStreetMaps vybereme vhodné typy cest v\ daném okrese

- silnice mírně zjednodušíme

- silnice rozdělíme na krátké úseky o\ délce cca 5\ m (*lixely*)

- nehody posuneme na silniční síť; příliš vzdálené nehody zahodíme

- přidělíme nehodám váhy (stejné nebo odvozené od VSL)

- spočítáme NKDE pro každý *lixel* silniční sítě: spojitě nebo nespojitě
    - Gelb, J.: spNetwork, a Package for Network Kernel Density Estimation, *The R Journal*, 2021

![](McSwiggan_nkde_non_cont.png){width=100%}



## Praktický postup hledání klastrů

\rightfig[0.3][klastr.png]

\

\

- najdeme *lixely* s vysokou hodnotou NKDE

- rekurzivně spojíme *lixely* s vysokou NKDE, které sousedí

- takto získané klastry rekurzivně zvětšíme do všech stran o\ daný počet *lixelů*
    - některé nehody, které významně přispěly k\ výši NKDE jinak leží mimo klastr

- spojíme klastry, které se dotýkají\ / překrývají

- ke každému klastry přiřadíme nehody, které leží na *lixelech*, které tvoří daný klastr

- spočítáme závažnost klastru = závažnost nehod v\ klastru (odvozeně od VSL)



## Interpretace klastrů nehod

Klastry nejsou "zjevená pravda":

- Klastry ukazují *x* promile nejhorších úseků rozšířených o *n* *lixelů*.

- Pro různá promile nejhorších úseků *x* a rozšíření *n* budou klastry vypadat různě.

- Může se změnit i\ pořadí klastrů seřazených podle způsobené škody.

\

Detekce klastrů nemá sloužit jako automat, ale pomoci policistovi zaměřit pozornost na problematická místa.

Konečné rozhodnutí musí vždy záležet na posouzení policisty.

Ten by měl vyzkoušet různé pohledy na data (nastavení *x* a *n*), tak najít problémová místa, a\ pak se dívat na mapu skutečných nehod\ -- a\ přitom zohlednit svou expertní znalost svého okresu.



## Zdroje obrázků

- McSwiggan et al.: Kernel Density Estimation on a Linear Network, *Scandinavian Journal of Statistics*, 2016

- Wikipedia: *Kernel density estimation*

